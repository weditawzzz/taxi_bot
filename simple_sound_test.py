# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª: direct_sound_test.py

"""
–ü—Ä—è–º–æ–π —Ç–µ—Å—Ç –∑–≤—É–∫–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
"""
import asyncio
from aiogram import Bot

# –í–°–¢–ê–í–¨–¢–ï –°–Æ–î–ê –í–ê–®–ò –¢–û–ö–ï–ù–´ –ò ID –ù–ê–ü–†–Ø–ú–£–Æ
DRIVER_BOT_TOKEN = "8012773257:AAHuhGx8TwaEP1KPooBFAq8EfUNSRZfmJtM"
DRIVER_IDS = ['628521909','6158974369']  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ ID –≤–æ–¥–∏—Ç–µ–ª–µ–π


async def test_sound_directly():
    """–ü—Ä—è–º–æ–π —Ç–µ—Å—Ç –∑–≤—É–∫–∞"""

    # –°–æ–∑–¥–∞–µ–º –±–æ—Ç –Ω–∞–ø—Ä—è–º—É—é
    driver_bot = Bot(token=DRIVER_BOT_TOKEN)

    print("üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–≤—É–∫–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤–æ–¥–∏—Ç–µ–ª—è–º...")

    for i, driver_id in enumerate(DRIVER_IDS, 1):
        try:
            print(f"\n{i}. –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–æ–¥–∏—Ç–µ–ª—é {driver_id}...")

            # –¢–µ—Å—Ç 1: –û–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∑–≤—É–∫–∞
            await driver_bot.send_message(
                chat_id=int(driver_id),
                text="üîäüîäüîä –¢–ï–°–¢ –ó–í–£–ö–ê üîäüîäüîä",
                disable_notification=False,
                protect_content=False
            )

            await asyncio.sleep(0.5)

            # –¢–µ—Å—Ç 2: –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            await driver_bot.send_message(
                chat_id=int(driver_id),
                text=(
                    "üîî <b>–¢–ï–°–¢ –ó–í–£–ö–û–í–û–ì–û –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø</b>\n\n"
                    "–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ:\n"
                    "‚úÖ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ\n"
                    "üîä –ë—ã–ª –ª–∏ –∑–≤—É–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?\n\n"
                    "<b>–ï—Å–ª–∏ –∑–≤—É–∫–∞ –ù–ï–¢, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:</b>\n"
                    "1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Üí –ó–≤—É–∫ –≤ Telegram\n"
                    "2. –ì—Ä–æ–º–∫–æ—Å—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ\n"
                    "3. –¢–µ–ª–µ—Ñ–æ–Ω –Ω–µ –≤ –±–µ–∑–∑–≤—É—á–Ω–æ–º —Ä–µ–∂–∏–º–µ\n"
                    "4. –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è Telegram –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–∏—Å—Ç–µ–º—ã"
                ),
                parse_mode="HTML",
                disable_notification=False,
                protect_content=False
            )

            await asyncio.sleep(0.5)

            # –¢–µ—Å—Ç 3: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∑–≤—É–∫–æ–≤–æ–π —Å–∏–≥–Ω–∞–ª
            await driver_bot.send_message(
                chat_id=int(driver_id),
                text="üö® –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –ó–í–£–ö–û–í–û–ô –°–ò–ì–ù–ê–õ üö®",
                disable_notification=False
            )

            print(f"‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤–æ–¥–∏—Ç–µ–ª—é {driver_id}")

            await asyncio.sleep(2)  # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –≤–æ–¥–∏—Ç–µ–ª—è–º–∏

        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—è {driver_id}: {e}")
            print(f"   –í–æ–∑–º–æ–∂–Ω–æ ID {driver_id} –Ω–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –≤–æ–¥–∏—Ç–µ–ª—å –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª –±–æ—Ç–∞")

    print(f"\nüèÅ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!")
    print("\nüì± –ò–ù–°–¢–†–£–ö–¶–ò–ò –î–õ–Ø –í–û–î–ò–¢–ï–õ–ï–ô:")
    print("=" * 50)
    print("1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—É—á–∏–ª–∏ –ª–∏ –≤—ã 3 —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –±–æ—Ç–∞")
    print("2. –ë—ã–ª –ª–∏ –∑–≤—É–∫ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π?")
    print("\nüîß –ï–°–õ–ò –ó–í–£–ö–ê –ù–ï–¢:")
    print("‚Ä¢ –í Telegram: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Üí –ó–≤—É–∫")
    print("‚Ä¢ –ù–∞–π–¥–∏—Ç–µ –±–æ—Ç–∞ –≤ —Å–ø–∏—Å–∫–µ —á–∞—Ç–æ–≤ ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —á–∞—Ç–∞ ‚Üí –ó–≤—É–∫")
    print("‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥—Ä–æ–º–∫–æ—Å—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —Å–∏—Å—Ç–µ–º–µ")
    print("‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–µ –≤ —Ä–µ–∂–∏–º–µ '–ù–µ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å'")
    print("‚Ä¢ –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è Telegram –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–∞")

    # –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–µ—Å—Å–∏—é –±–æ—Ç–∞
    await driver_bot.session.close()


async def test_driver_availability():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–æ–¥–∏—Ç–µ–ª–µ–π"""

    driver_bot = Bot(token=DRIVER_BOT_TOKEN)

    print("\nüîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–æ–¥–∏—Ç–µ–ª–µ–π...")

    for driver_id in DRIVER_IDS:
        try:
            # –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —á–∞—Ç–µ
            chat = await driver_bot.get_chat(int(driver_id))
            print(f"‚úÖ –í–æ–¥–∏—Ç–µ–ª—å {driver_id}: {chat.full_name or chat.first_name}")

        except Exception as e:
            print(f"‚ùå –í–æ–¥–∏—Ç–µ–ª—å {driver_id} –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: {str(e)}")
            if "chat not found" in str(e).lower():
                print(f"   ‚Üí –í–æ–¥–∏—Ç–µ–ª—å —Å ID {driver_id} –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª –±–æ—Ç–∞ (/start)")
            elif "bot was blocked" in str(e).lower():
                print(f"   ‚Üí –í–æ–¥–∏—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞")

    await driver_bot.session.close()


async def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    print("üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–≤—É–∫–æ–≤—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π...")
    print("=" * 50)

    try:
        # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–æ–¥–∏—Ç–µ–ª–µ–π
        await test_driver_availability()

        print("\n" + "=" * 50)

        # –ó–∞—Ç–µ–º —Ç–µ—Å—Ç–∏—Ä—É–µ–º –∑–≤—É–∫
        await test_sound_directly()

    except KeyboardInterrupt:
        print("\nüõë –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ—Ä–≤–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        print(f"‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()


if __name__ == "__main__":
    asyncio.run(main())